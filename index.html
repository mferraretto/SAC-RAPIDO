<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="theme-color" content="#0b5ed7" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>SAC – Central de Perguntas e Respostas</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet" />
</head>
<body>
  <header class="app-header">
    <div class="logo">SAC</div>
    <nav class="auth-nav">
      <span id="userEmail" class="muted"></span>
      <button id="btnInstall" class="btn btn-ghost" hidden>Instalar app</button>
      <button id="btnLogout" class="btn btn-ghost" style="display:none">Sair</button>
    </nav>
  </header>

  <section id="offlineBanner" class="banner banner-offline" hidden>
    <span class="material-symbols-rounded" aria-hidden="true">cloud_off</span>
    <span>Você está offline. Algumas funcionalidades podem ficar indisponíveis.</span>
  </section>

  <section id="updateBanner" class="banner banner-update" hidden>
    <span class="material-symbols-rounded" aria-hidden="true">system_update_alt</span>
    <span>Uma nova versão do aplicativo está disponível.</span>
    <button id="btnRefresh" class="btn btn-sm">Atualizar agora</button>
  </section>

  <main class="container">
    <!-- Login / Registro -->
    <section id="authSection" class="card auth-card">
      <h2>Acessar</h2>
      <form id="authForm">
        <label>E-mail
          <input type="email" id="email" required placeholder="voce@exemplo.com"/>
        </label>
        <label>Senha
          <input type="password" id="password" required placeholder="********"/>
        </label>
        <div class="row gap">
          <button type="submit" id="btnLogin" class="btn">Entrar</button>
          <button type="button" id="btnRegister" class="btn btn-secondary">Criar conta</button>
        </div>
      </form>
      <p class="muted small">Login com Firebase (Email/Senha).</p>
    </section>

    <!-- App -->
    <section id="appSection" style="display:none;">
      <div class="toolbar card">
        <div class="row between">
          <div class="row gap">
            <button id="btnSeed" class="btn btn-secondary" title="Carrega a base inicial se sua coleção estiver vazia">Carregar base (seed)</button>
            <button id="btnReload" class="btn btn-ghost">Recarregar</button>
          </div>
          <div class="row gap" id="searchTools">
            <input id="searchInput" class="input" type="search" placeholder="Buscar por pergunta/resposta...">
            <button id="btnClear" class="btn btn-ghost" title="Limpar busca">Limpar</button>
          </div>
        </div>
      </div>

      <!-- Abas (categorias) -->
      <div id="tabs" class="tabs"></div>

      <section id="faqSection">
        <!-- Lista de Q&A -->
        <div id="qaList" class="qa-list"></div>

        <!-- Novo Q&A -->
        <div class="card" id="newQaCard">
          <h3>Novo Q&A</h3>
          <form id="newForm" class="grid-2">
            <label>Categoria
              <input type="text" id="newCategory" list="catList" placeholder="Ex.: Entrega &amp; Prazo" required>
              <datalist id="catList"></datalist>
            </label>
            <label>Pergunta / Enunciado
              <input type="text" id="newQuestion" placeholder="Digite a pergunta..." required>
            </label>
            <label class="grid-span-2">Resposta
              <textarea id="newAnswer" rows="6" placeholder="Cole a resposta exata aqui..." required></textarea>
            </label>
            <div class="grid-span-2 right">
              <button class="btn" type="submit">Salvar</button>
            </div>
          </form>
        </div>
      </section>

      <section id="tipsSection" style="display:none;">
        <div class="card">
          <h3>Nova dica ou recomendação</h3>
          <form id="tipsForm" class="grid-2">
            <label>Categoria
              <input type="text" id="tipCategory" list="tipCatList" placeholder="Ex.: Pós-venda" required>
              <datalist id="tipCatList"></datalist>
            </label>
            <label class="grid-span-2">Dica ou recomendação
              <textarea id="tipContent" rows="5" placeholder="Digite a dica ou recomendação..." required></textarea>
            </label>
            <div class="grid-span-2 right">
              <button class="btn" type="submit">Salvar dica</button>
            </div>
          </form>
        </div>
        <div id="tipsList" class="tips-list"></div>
      </section>

      <section id="summarySection" style="display:none;">
        <div class="card summary-card">
          <h3>Resumo de cópias</h3>
          <div class="summary-controls">
            <label>Data inicial
              <input type="date" id="summaryDateFrom">
            </label>
            <label>Data final
              <input type="date" id="summaryDateTo">
            </label>
            <button type="button" id="summaryClearFilters" class="btn btn-ghost">Limpar filtros</button>
          </div>
          <p class="muted small" id="summaryTotals"></p>
        </div>
        <div id="summaryList" class="card summary-table-card"></div>
      </section>
    </section>

    <!-- Modal editar -->
    <dialog id="editDialog" class="dialog">
      <form method="dialog" id="editForm" class="card">
        <h3>Editar Q&A</h3>
        <input type="hidden" id="editId">
        <label>Categoria
          <input type="text" id="editCategory" required>
        </label>
        <label>Pergunta / Enunciado
          <input type="text" id="editQuestion" required>
        </label>
        <label>Resposta
          <textarea id="editAnswer" rows="8" required></textarea>
        </label>
        <div class="row right gap">
          <button class="btn btn-ghost" value="cancel">Cancelar</button>
          <button class="btn" value="default" id="btnSaveEdit">Salvar</button>
        </div>
      </form>
    </dialog>

    <!-- Modal editar Pós-vendas -->
    <dialog id="posCardDialog" class="dialog">
      <form method="dialog" id="posCardForm" class="card">
        <h3>Editar card Pós-vendas</h3>
        <input type="hidden" id="posCardId">
        <label>Seção
          <select id="posCardSection" required>
            <option value="top">Fluxo principal</option>
            <option value="bottom">Opções de resolução</option>
          </select>
        </label>
        <label>Visual
          <select id="posCardVariant" required>
            <option value="case">Caso</option>
            <option value="option">Opção</option>
          </select>
        </label>
        <label>Título
          <input type="text" id="posCardTitle" required>
        </label>
        <label>Parágrafos (um por linha)
          <textarea id="posCardParagraphs" rows="6" placeholder="Digite cada parágrafo em uma nova linha"></textarea>
        </label>
        <label>Lista com marcadores (um item por linha)
          <textarea id="posCardBullets" rows="6" placeholder="Digite cada item em uma nova linha"></textarea>
        </label>
        <label>Nota final
          <textarea id="posCardNote" rows="3" placeholder="Observação opcional"></textarea>
        </label>
        <div class="row right gap">
          <button class="btn btn-ghost" value="cancel">Cancelar</button>
          <button class="btn" value="default" type="submit">Salvar card</button>
        </div>
      </form>
    </dialog>
  </main>

  <footer class="footer muted small">
    <span>SAC • Firebase Firestore • © 2025</span>
  </footer>

  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
